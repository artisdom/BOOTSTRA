@ECHO OFF

IF %1==/B GOTO :ARGB

TYPE %1 > ASINPUT.BAT
SET OUTFILE=%2

GOTO :START

:ARGB
SET OLDPATH=%PATH%
SET PATH=%2;%PATH%
CALL %2\AS %3 %4 %5 %6 %7 %8 %9
SET PATH=%OLDPATH%
SET OLDPATH=
GOTO :EOF

:START

IF EXIST %OUTFILE% DEL %OUTFILE%

SET MODE=COUNT
SET IP=256
CALL ASINPUT

CALL CLRFILE > %OUTFILE%

SET MODE=EMIT
SET IP=256
CALL ASINPUT

SET MODE=CLEAN
CALL ASINPUT

DEL ASINPUT.BAT
SET OUTFILE=
SET MODE=
SET IP=
SET REG=
SET MRM=
SET DISPBYTES=
SET RESULT=
:EOF
